{# ui/templates/ui/personas/estudiante_form.html #}
{% extends "ui/base.html" %}
{% load static %}

{% block content %}
<div class="rounded-3xl border border-slate-200 bg-white/80 p-6 md:p-8">
  <div class="mb-6">
    <h1 class="text-xl font-semibold">Nuevo Estudiante</h1>
    <p class="text-sm text-slate-600">Completá los datos básicos del estudiante.</p>
  </div>

  <form method="post" enctype="multipart/form-data" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    {% csrf_token %}

    <!-- Columna izquierda -->
    <div class="space-y-4 lg:col-span-2">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.apellido.id_for_label }}">Apellido</label>
          {{ form.apellido }}
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.nombre.id_for_label }}">Nombre</label>
          {{ form.nombre }}
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.dni.id_for_label }}">DNI</label>
          {{ form.dni }}
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.fecha_nacimiento.id_for_label }}">Fecha nacimiento</label>
          {{ form.fecha_nacimiento }}
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.lugar_nacimiento.id_for_label }}">Lugar de nacimiento</label>
          {{ form.lugar_nacimiento }}
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.email.id_for_label }}">Email</label>
          {{ form.email }}
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.telefono.id_for_label }}">Teléfono</label>
          {{ form.telefono }}
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.localidad.id_for_label }}">Localidad</label>
          {{ form.localidad }}
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.contacto_emergencia_tel.id_for_label }}">Tel. de emergencia</label>
          {{ form.contacto_emergencia_tel }}
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1" for="{{ form.contacto_emergencia_parentesco.id_for_label }}">Parentesco (emergencia)</label>
          {{ form.contacto_emergencia_parentesco }}
        </div>
      </div>

      <label class="inline-flex items-center gap-2 text-sm font-medium text-slate-700">
        {{ form.activo }}
        <span>Activo</span>
      </label>

      <div class="pt-2">
        <button type="submit"
                class="inline-flex items-center rounded-xl bg-blue-600 px-4 py-2 text-white shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-300">
          Guardar
        </button>
        <a href="{% url 'ui:dashboard' %}"
           class="ml-2 inline-flex items-center rounded-xl border border-slate-300 px-4 py-2 text-slate-700 hover:bg-slate-50">
          Cancelar
        </a>
      </div>
    </div>

    <!-- Columna foto -->
    <div>
      <div class="rounded-2xl border border-slate-200 p-4">
        <label class="block text-sm font-medium mb-2">Foto</label>

        <div class="mb-3 flex items-center gap-3">
          {% static 'ui/img/avatar-default.svg' as AVATAR_DEFAULT %}
          <img id="previewFoto"
               src="{{ AVATAR_DEFAULT }}"
               class="h-24 w-24 rounded-xl object-cover border border-slate-200"
               alt="Vista previa">

          <div class="flex-1">
            {{ form.foto }}
            <p class="text-xs text-slate-500 mt-1">Formatos: JPG/PNG. Tamaño razonable.</p>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>

<script>
// Vista previa de imagen
(function() {
  const input = document.getElementById("{{ form.foto.id_for_label }}");
  const img   = document.getElementById("previewFoto");
  if (input && img) {
    input.addEventListener("change", (e) => {
      const file = e.target.files && e.target.files[0];
      if (file) {
        img.src = URL.createObjectURL(file);
      }
    });
  }
})();
</script>
{% endblock %}